# Excel Reader

This application allows its user to insert an ExcelWorkSheet using the library EPPlus into a database in Sqlserver with EFCore.
The template can be generated by the users with some constraints.

## Usage

The user has to configure the appsettings.json with the following:

1. Path (Optional): The absolute or relative path to the .xlsx file to insert
   (Note: absolute path just tested on Linux).
   By default uses the path to the supplied "Template.xlsx" file.
2. ConnectionString: The connection string for SqlServer.

## Template Generation

The template supplied by the user has to comply with the following constraints:

1. First Column as Primary Key: By default the app asumes the first column will be the Id of each row.
   Currently the primary key has to be of integer type to be supported. If the Id of one cell is duplicated
   the worksheet will not be added to the database.
2. Date Type identifier for each column: The app uses excel data types by default. If the user wants to convert the
   column value to another type, the specific column has to be identified by adding the data type in parentheses. Currently
   the following types are supported: (date), (int), (double).
3. Invalid Values get mapped to null: Each cell value that excel identifies as invalid will be mapped to null
   in the database. This includes cell with text values instead of the correct format. For example if a cell uses
   the wrong date format it will identify that cell as text and will be stored as null in the database.
4. Formulas get their result stored: The formula is not saved to the database, instead the formula gets
   evaluated and its result stored to the database.

The following is an example of a valid template:

![image](https://github.com/ManuelE-Osorio/CodeReviews.Console.ExcelReader/assets/147839063/93bf6386-75e0-42f2-b480-9afc270f133d)


## To Do

1. Add a WorkBook model than is able to contain multiple WorkSheets.
   (ExcelWorkBookModel -> ExcelWorkSheetModel -> ExcelRowModel -> ExcelCellData)
2. Add a ExcelColumn model to map each cell to its Column Id instead of using
   the column title.
3. Add more ExcelCell types.
4. Handle null cells as null values (issue with int and double cells)

## References

1. <https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/accessibility-levels>
2. <https://learn.microsoft.com/en-us/dotnet/fundamentals/runtime-libraries/system-dynamic-expandoobject>
3. <https://stackoverflow.com/questions/9613421/map-a-dictionary-in-entity-framework-code-first-approach>
4. <https://stackoverflow.com/questions/4938397/dynamically-adding-properties-to-an-expandoobject>
5. <https://www.site24x7.com/learn/ihostedservice-and-backgroundservice.html>
6. <https://stackoverflow.com/questions/77890236/what-does-ihost-run-or-runasync-do-in-a-net-8-console-app>
